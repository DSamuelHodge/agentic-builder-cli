/* Workflow template (TypeScript)
 * Replace pseudo scheduler/queue with Restack workflow APIs.
 */

import type { AgentContext, WorkflowRunContext } from "../types.js";
import { create{{ pascal_name }} } from "../agents/{{ name }}.js";

export interface {{ pascal_name }}WorkflowInput {
  seedMessage?: string;
}

export async function run{{ pascal_name }}Workflow(
  input: {{ pascal_name }}WorkflowInput,
  ctx: WorkflowRunContext
) {
  const agent = create{{ pascal_name }}(ctx.llm, { model: ctx.config.model });

  const messages = [
    { role: "system", content: "You are orchestrating a simple workflow." },
    { role: "user", content: input.seedMessage ?? "Hello agent!" },
  ];

  const res = await agent.run(messages, ctx as unknown as AgentContext);
  ctx.log.info("Workflow result:", res[res.length - 1]?.content);

  // example: enqueue next task / emit event
  // await ctx.queue.enqueue("next-stage", { ...payload });

  return { status: "completed", messages: res };
}